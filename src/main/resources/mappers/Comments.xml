<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.gathering.mapper.CommentsMapper">
    
    <!--  Qna 댓글 작성 -->
     <insert id="insertComment" parameterType="com.gathering.dto.CommentsVO" >
      INSERT INTO comments(comment_seq, qna_seq, user_id, content, regDate) 
         VALUES(product_comment_seq.NEXTVAL, #{qna_seq}, #{user_id}, #{content}, #{regDate})
  	 </insert>

	<!-- Qna댓글  총 개숫 -->
	<select id="getTotal" resultType="int">
		SELECT count(*) from comments WHERE qna_seq=#{qna_seq}
	</select>

	<!--  Qna 댓글 리스트  -->
   <select id="commentList" parameterType="int" resultType="com.gathering.dto.CommentsVO">
      SELECT * FROM comments WHERE comment_seq=#{comment_seq} ORDER BY regDate DESC
   </select>
   
   <!-- Qna댓글 페이징 -->
   	<select id="commentListWithPaging" resultType="com.gathering.dto.CommentsVO">
    <![CDATA[
       		 SELECT * FROM(
        				SELECT  rownum  as rn, user_id, content, regDate  FROM comments WHERE qna_seq=#{qna_seq} AND rownum <= #{pageNum} * #{amount} )
	       				 WHERE rn > (#{pageNum} -1) * #{amount} ORDER BY regDate DESC
	    ]]>
	</select>
   
   
</mapper>